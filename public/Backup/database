CREATE TABLE Carrello (
        EmailUtente TEXT,
        SessionID TEXT NOT NULL,
        IDProdotto INTEGER NOT NULL,
        Quantita INTEGER NOT NULL,
        PRIMARY KEY(EmailUtente, SessionID, IDProdotto),
        FOREIGN KEY(EmailUtente) REFERENCES Utenti(Email),
        FOREIGN KEY(IDProdotto) REFERENCES Prodotti(ID)
    );

CREATE TABLE "DettagliOrdine" (
    "ID" INTEGER NOT NULL UNIQUE,
    "IDOrdine" INTEGER NOT NULL,  -- Collegato all'ordine
    "IDProdotto" INTEGER NOT NULL,  -- Collegato al prodotto
    "Quantita" INTEGER NOT NULL,  -- Quantit√† del prodotto nell'ordine
    "PrezzoUnitario" REAL NOT NULL,  -- Prezzo al momento dell'acquisto
    PRIMARY KEY("ID" AUTOINCREMENT),
    FOREIGN KEY("IDOrdine") REFERENCES "Ordini"("ID"),
    FOREIGN KEY("IDProdotto") REFERENCES "Prodotti"("ID")
);

/*Queste ci sono in server.js*/

CREATE TABLE Ordini (
    ID INTEGER NOT NULL UNIQUE,
    EmailUtente TEXT NOT NULL,
    Indirizzo TEXT NOT NULL,
    NumeroDiTelefono TEXT NOT NULL,
    Data TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    Totale REAL NOT NULL,
    PRIMARY KEY(ID AUTOINCREMENT),
    FOREIGN KEY(EmailUtente) REFERENCES Utenti(Email),
    FOREIGN KEY(Indirizzo) REFERENCES Utenti(Indirizzo),
    FOREIGN KEY(NumeroDiTelefono) REFERENCES Utenti(NumeroDiTelefono)
);

CREATE TABLE Prodotti (
    ID INTEGER NOT NULL UNIQUE,
    Nome TEXT NOT NULL UNIQUE,
    Prezzo REAL NOT NULL,
    Quantita INTEGER NOT NULL,
    Categoria TEXT NOT NULL,
    Disponibile BOOLEAN NOT NULL DEFAULT 1,
    Immagine TEXT NOT NULL,
    Descrizione TEXT NOT NULL,
    PRIMARY KEY(ID AUTOINCREMENT)
);

CREATE TABLE Utenti (
    Email TEXT NOT NULL UNIQUE,
    Password TEXT NOT NULL,
    Nome TEXT NOT NULL,
    Cognome TEXT NOT NULL,
    Indirizzo TEXT NOT NULL,
    NumeroDiTelefono TEXT NOT NULL,
    AccessoSpeciale BOOLEAN NOT NULL DEFAULT 0,
    PRIMARY KEY(Email)
);